---
title: "RWorksheet_calvario#4c.Rmd"
author: "Jolien"
date: "2024-11-19"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Use the dataset mpg

# a. Solutions on how to import a csv file into the environment.

```{r}
library(ggplot2)

mpg_data <- read.csv("mpg.csv")
str(mpg_data)
```

# b. Which variables from mpg dataset are categorical?

# The categorical variables in the mpg dataset are manufacturer, model, trans, drv, fl, and class. These represent distinct groups or categories, such as car brand, transmission type, drivetrain, fuel type, and car class.


# c. Which are continuous variables?

# The continuous variables in the mpg dataset are displ, cty, hwy, and cyl, as they represent measurable numerical values.


# 2.1. Which manufacturer has the most models in this data set? Which model has the most variations? Show your answer.

# a. Group the manufacturers and find the unique models. Show your codes and result.

```{r}
library(dplyr)
manufacturer_model <- mpg %>%
  group_by(manufacturer) %>%
  summarize(model_num = n_distinct(model)) %>%
  arrange(desc(model_num))

manufacturer_model

variations_num <- table(mpg$model)
variations_num [variations_num == max(variations_num)]
```


# b. Graph the result by using plot() and ggplot(). Write the codes and its result.

```{r}
manufacturer_data <- setNames(
  manufacturer_model$model_num, 
  manufacturer_model$manufacturer
  )

barplot(manufacturer_data, 
        main = "Number of Models per Manufacturer",
        xlab = "Manufacturer",
        ylab = "Number of Models",
        col = c("violet", "pink", "lightgreen", "lavender", "lightblue"),
        las = 3)

variations_num <- mpg %>%
  group_by(model) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

variations_num

ggplot(variations_num, aes(x = reorder(model, count), y = count)) +
  geom_bar(stat = "identity", fill = "violet") + 
  coord_flip() +
  labs(title = "Number of Variations per Model", x = "Model", y = "Count") +
  theme_light()   
```

 
 

# 2.2. Same dataset will be used. You are going to show the relationship of the modeland the manufacturer.

# a. What does ggplot(mpg, aes(model, manufacturer)) + geom_point() show?

```{r}
ggplot(mpg, aes(model, manufacturer)) + geom_point()
```

# ggplot(mpg, aes(model, manufacturer)) + geom_point() creates a scatter plot showing the relationship between car models (model) on the x-axis and manufacturers (manufacturer) on the y-axis, with each point representing a car observation.


# b. For you, is it useful? If not, how could you modify the data to make it more informative? 

# In its current form, this plot isn't very useful as it doesn't effectively visualize the relationship between car models and manufacturers. Since both variables are categorical, a scatter plot isn't the most appropriate way to represent this relationship.
 

# 3. Plot the model and the year using ggplot(). Use only the top 20 observations. Write the codes and its results.

```{r}
ggplot(head(mpg_data, 20), aes(x = model, y = year)) +
  geom_point() +
  labs(title = "Model vs Year (Top 20 Observations)", x = "Model", y = "Year") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

